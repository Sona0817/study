# 빌라/연립 매매가격 예측 모델
작성자 sona 0817

## 1.	INTRODUCTION
알토마토에서 제공한 빌라/연립 매물에 대한 전국단위 매매가격을 토대로 새롭게 등록되는 매물의 거래가가 적정한지 판단하기 위해 빌라/연립 매매가격을 예측하는 모델을 구축한다.


## 2.	DATASET
### 2.1. Dataset Collection
* Data Provider: Rtomato
* Data Collection Period: 2016.01.01 ~ 2021.07.22
*	File Format: csv
*	Data: houses, houserds

### 2.2. Data Preprocessing
*	houses는 건물 정보로 중복된 건물이 없도록 위도, 경도, 주소를 활용해 중복 데이터 제거 및 유니크한 건물 데이터로 전처리
*	houserds는 매물 정보로 거래금액이 동일한 원단위가 되도록 정리, 면적 정리(총면적, 용적률 등), 거래 날짜 통일, 동일 매물에 대한 마지막 거래 날짜 생성, 건물 연식 생성
*	해당 매물에 대한 상승률 생성, 1일 상승률 생성, 해당지역(동 기준)에 대한 상승률 생성, 거래경과일수 생성
*	거래금액으로 target 지정

## 3.	METHOD
거래 매물에 대한 위도, 경도, 지역, 면적, 층수, 지어진 년도, 건물 연식, 지난거래금액, 상승률, 거래경과일수, 1일 상승률, 지역별(동 기준) 1일 상승률을 이용해 현재 실거래가를 예측하는 모델을 만든다.

### 3.1. Modeling Pipeline
*	Load Data : 알토마토에서 제공한 전국 빌라/연립 매물 매매 정형 데이터
*	Data Analysis : 전체 데이터 병합 및 결측값 처리, 특성 파악, 상관관계 분석
* Feature Engineering : 집값에 영향을 미치는 요소에 따른 컬럼 생성, 삭제 및 선택
1)	반영 컬럼 : longi, lati, 시도, 구군
-	가정 : 지역에 따라 집값에 영향을 미치는 정도가 다르다.
-	근거 : 강남구 매매가격의 변화는 주로 주변 인접지역의 매매가격 변화에 영향을 주며 그 영향은 분당, 과천 등 수도권 일부지역까지 파급될 수 있다고 결론지을 수 있다. (주택가격 변화의 지역연관성에 관한 연구 – 강남구 물결 효과를 중심으로, 서승환, 2007)
-	구분 : [머신러닝 기법을 통한 대한민국 부동산 가격 변동 예측, 남상현, 2020]을 보면 서울은 강남, 강북으로 나누고 전국은 경기, 인천, 대전, 울산, 강원, 충청, 전라, 경상 등 시도를 중심으로 구분하였다. 따라서 본 데이터 전처리 과정에서도 시도, 구군, 동으로 구분하여 적용하였다.

2)	반영 컬럼 : buildyear
-	가정 : 최근에 지어진 건물 또는 오래되어서 재건축 확률이 높은 건물을 선호
-	근거 : 주택의 시장가치는 건축물의 가치 + 토지의 가치로 본다. 시간에 따라 건물의 가치는 하락하나 토지의 입지 가치가 증가하게 되어 주택 자산의 최유효이용 가치가 U로 상승하게 된다. 재건축 가능성이 존재하는 경우 건축물의 가치도 올라간다. 재건축 이후 건축물의 가치가 최고점을 찍는다. (경과 년 수와 용적률의 상호작용을 고려한 아파트 가격 형성 분석, 김천일, 2018)
-	구분 : 네이버부동산에서는 5년단위로 매물을 구분한다. 본 데이터에서는 (현재 년도 – 승인 년도)를 계산한 건물 연식을 적용한다.

3)	반영 컬럼 : groundarea, proarea
-	가정 : 용적률이 클수록(전용면적이 많을수록) 구입 선호
-	근거 : 평단 평균 매매가는 대지면적, 연면적, 총 세대수, 평균 층수, 전용면적, 주동수 변수와 상관성이 높은 것으로 분석되었으며, 양의 관계를 보였다. (주상복합아파트의 주택 규모별 가격결정요인 분석, 송호창, 2008)
-	구분 : [주상복합아파트의 주택 규모별 가격결정요인 분석]에 따르면 평균 용적률이 102.85제곱미터(31.2평)으로 나타났는데 아파트기준이기 때문에 새로운 구분 기준이 필요하다. 본 데이터에서는 해당 매물의 총면적, 대지면적, 용적률을 적용하였다.

*	Data Split : 데이터 분리
*	Model Build & Train : 모델 구축 및 훈련
*	Model Validation : 모델 검증
*	Model Serving : 모델 저장

### 3.2. Algorithm & Methodology
모델 구축 시 사용된 알고리즘은 XGBoost Regression로 XGBoost는 선형 모델이나 트리 기반 모델에서의 과접합 문제를 해결하고, 규모가 큰 데이터 셋의 안정성과 훈련 속도를 향상시키기 위한 목적으로 Tianqi Chen과 Carlos Guestring이 소개한 방법이다. eXtreme Gradient Boosting의 약자로 boosting algorithm 기반 모델이며, 회귀와 분류, 순위 및 사용자 정의 objective를 지원하는 유연한 모델이다. 본 프로젝트에서는 회귀 모델로 사용하였다.

### 3.3. Evaluation & Result
*	모델 적용 기준
지난 거래 날짜와 관계없이 실거래가를 예측하는 모델을 구축하였다. 과거 거래 기록이 없는 경우 또는 과거 거래일이 너무 오래된 경우에는 모델을 적용하여 실거래가를 예측하는 것이 타당하다. 하지만 거래가 이루어진 지 얼마 되지 않은 매물의 경우 모델로 예측하는 것보다 최근 거래금액이 더 확실한 실거래가이므로 본 프로젝트에서는 지난 거래일이 90일보다 오래된 매물일 경우 모델을 적용하도록 하였다.

-	최근 3개월(90일) 이내 거래된 매물 : 최근 거래가격 적용
-	마지막 거래일이 3개월(90일) 이상 된 매물 : 모델 적용

## 4.	CONCLUSION
* 모델을 적용한 이후 랜덤한 50개 데이터 추출, 결과 확인

![image](https://user-images.githubusercontent.com/80690009/161877893-0fcbe6b6-ee10-4edb-a01f-d0a1fab3d177.png)

* 마지막 거래 가격과 예측 가격 확인

![image](https://user-images.githubusercontent.com/80690009/161877903-57380dcf-0f53-4070-89f2-2da45a4faa9e.png)

*	원하는 매물 정보 확인
id, floor, proarea, groundarea 값을 입력하면 해당 매물에 대한 정보와 예측 값 출력

![image](https://user-images.githubusercontent.com/80690009/161877920-ad517ebc-2d39-4906-a57e-1ca97466d804.png)

*	최근 3개월(90일)이내 거래된 매물 예측 검증 결과
  - MAE : 3166185
  - MAPE : 0.990
  - R-square : 0.959

*	마지막 거래일이 3개월(90일) 이상 된 매물 예측 검증 결과
  -	MAE : 2106101
  - MAPE : 0.991
  - R-square : 0.994

## REFERENCES
* 서승환, “주택가격 변화의 지역연관성에 관한 연구 – 강남구 물결효과를 중심으로”, 2007
* 남상현, “머신러닝 기법을 통한 대한민국 부동산 가격 변동 예측”, 2020
* 김천일, “경과 년수와 용적률의 상호작용을 고려한 아파트 가격 형성 분석”, 2018
* 송호창, “주상복합아파트의 주택규모별 가격결정요인 분석”, 2008
* Chen, T., and Guestrin, C., “XGBoost: A Scalable Tree Boosting System.”, KDD’16, 2016, pp. 785-794.
